<div class="relative flex min-h-screen w-full flex-col mx-auto max-w-md bg-background-light dark:bg-background-dark shadow-2xl overflow-hidden border-x border-slate-100 dark:border-slate-800">
  <!-- Header -->
  <div class="flex items-center justify-between p-4 sticky top-0 z-10 bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md border-b border-slate-100 dark:border-slate-800/50">
    <button 
      (click)="goBack()"
      class="flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-800 dark:text-white group">
      <span class="material-symbols-outlined group-hover:-translate-x-0.5 transition-transform">arrow_back_ios_new</span>
    </button>
    <div class="flex flex-col items-center">
      <h2 class="text-base font-bold text-slate-900 dark:text-white">Agente de Reservas</h2>
      <div class="flex items-center gap-1.5 mt-0.5">
        <div class="size-2 rounded-full bg-emerald-500 animate-pulse"></div>
        <span class="text-xs font-medium text-slate-500 dark:text-slate-400">En línea</span>
      </div>
    </div>
    <div class="w-10"></div>
  </div>

  <!-- Main Content -->
  <div class="flex-1 overflow-y-auto">
    <div class="px-6 pt-6 pb-2">
      <!-- Badge -->
      <div class="bg-slate-100 dark:bg-slate-800/50 inline-block px-3 py-1 rounded-lg mb-4">
        <span class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wide">Nueva Reserva</span>
      </div>

      <!-- Title -->
      <h1 class="text-slate-900 dark:text-white text-[32px] font-bold leading-[1.15] mb-6">
        ¿Qué necesitas <br/>
        <span class="icon-gradient-text">reservar hoy?</span>
      </h1>

      <!-- Search Input -->
      <div class="relative mb-8 group">
        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
          <span class="material-symbols-outlined text-slate-400 group-focus-within:text-primary transition-colors">search</span>
        </div>
        <input 
          type="text"
          [value]="searchQuery()"
          (input)="searchQuery.set($any($event.target).value)"
          placeholder="Buscar servicio..."
          class="block w-full pl-11 pr-4 py-3.5 bg-white dark:bg-[#1e1c30] border-none rounded-xl text-slate-900 dark:text-white placeholder:text-slate-400 shadow-[0_2px_8px_rgba(0,0,0,0.04)] focus:ring-2 focus:ring-primary/20 transition-all"
        />
      </div>

      <!-- Section Header -->
      <div class="flex items-center gap-4 mb-2">
        <span class="text-[11px] font-bold text-slate-400 uppercase tracking-widest whitespace-nowrap">Selecciona una categoría</span>
        <div class="h-px bg-slate-200 dark:bg-slate-700 w-full"></div>
      </div>
    </div>

    <!-- Categories -->
    <div class="px-4 pb-8 space-y-3">
      @for (category of categories; track category.id) {
        <div class="space-y-2">
          <!-- Main Category Button -->
          <button 
            (click)="toggleCategory(category)"
            class="w-full group relative flex items-center justify-between p-4 bg-white dark:bg-[#1e1c30] rounded-2xl shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_8px_20px_rgba(80,72,229,0.1)] border border-transparent hover:border-primary/20 transition-all duration-300">
            <div class="flex items-center gap-4">
              <div [class]="'flex size-12 items-center justify-center rounded-xl group-hover:scale-110 transition-transform duration-300 ' + category.bgColor">
                <span class="material-symbols-outlined">{{ category.icon }}</span>
              </div>
              <div class="text-left">
                <h3 class="text-base font-bold text-slate-900 dark:text-white leading-tight mb-0.5">{{ category.name }}</h3>
                <p class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ category.serviceCount }} servicios</p>
              </div>
            </div>
            <span 
              class="material-symbols-outlined text-slate-300 dark:text-slate-600 group-hover:text-primary transition-all duration-300"
              [class.rotate-180]="category.expanded">
              keyboard_arrow_down
            </span>
          </button>

          <!-- Subcategories (Expanded) -->
          @if (category.expanded && category.subcategories) {
            <div class="ml-4 space-y-2 animate-fade-in">
              @for (subcategory of category.subcategories; track subcategory.id) {
                <button
                  (click)="selectSubcategory(category, subcategory)"
                  class="w-full flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl hover:bg-white dark:hover:bg-slate-800 border border-transparent hover:border-primary/20 hover:shadow-sm transition-all duration-300 group/sub">
                  
                  <!-- Check/Arrow Icon -->
                  <div class="w-6 h-6 rounded-full bg-white dark:bg-slate-700 flex items-center justify-center text-slate-300 group-hover/sub:text-primary group-hover/sub:bg-primary/10 transition-colors">
                    <span class="material-symbols-outlined text-[16px]">arrow_forward</span>
                  </div>

                  <span class="text-sm font-medium text-slate-700 dark:text-slate-300 group-hover/sub:text-primary transition-colors">
                    {{ subcategory.name }}
                  </span>
                </button>
              }
            </div>
          }
        </div>
      }
    </div>
  </div>

  <!-- Decorative Background Elements -->
  <div class="pointer-events-none absolute top-[-150px] right-[-100px] size-[300px] rounded-full bg-purple-accent/5 blur-[80px]"></div>
  <div class="pointer-events-none absolute bottom-[-50px] left-[-50px] size-[250px] rounded-full bg-indigo-accent/5 blur-[80px]"></div>
</div>
