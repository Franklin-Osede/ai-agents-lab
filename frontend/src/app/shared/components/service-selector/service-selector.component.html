<div class="service-selector-container">
  <!-- Top App Bar -->
  <div class="top-app-bar">
    <!-- Back button removed to avoid redundancy with main modal header -->
    <h2 class="app-bar-title">Nueva Reserva</h2>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Headline -->
    <h1 class="headline">
      ¿Qué necesitas <br />
      <span class="highlight">reservar hoy?</span>
    </h1>

    <!-- Search Bar -->
    <div class="search-bar-wrapper">
      <label class="search-label">
        <div class="search-icon">
          <span class="material-symbols-outlined">search</span>
        </div>
        <input
          class="search-input"
          placeholder="Buscar servicio..."
          type="text"
          [(ngModel)]="searchQuery"
          />
      </label>
    </div>

    <!-- Section Label -->
    <h3 class="section-label">
      <span>Selecciona una Categoría</span>
      <div class="divider-line"></div>
    </h3>

    <!-- Category Accordions -->
    <div class="categories-list">
      @for (category of filteredCategories; track category) {
        <div
          class="category-accordion"
          [class.expanded]="category.expanded"
          >
          <!-- Category Header -->
          <button
            class="category-header"
            (click)="toggleCategory(category)"

            >
            <div class="category-icon-wrapper">
              <span class="material-symbols-outlined" [ngClass]="category.color">
                {{ category.icon }}
              </span>
            </div>
            <div class="category-info">
              <h4 class="category-name">{{ category.name }}</h4>
              <p class="category-count">{{ category.services.length }} servicios</p>
            </div>
            <div class="category-chevron">
              <span
                class="material-symbols-outlined"
                [class.rotated]="category.expanded"
                >
                expand_more
              </span>
            </div>
          </button>
          <!-- Services List (when expanded) -->
          @if (category.expanded) {
            <div class="services-dropdown">
              @for (service of category.services; track service) {
                <div
                  class="service-item"
                  (click)="onServiceClick(service, category)"
                  (keydown.enter)="onServiceClick(service, category)"
                  tabindex="0"
                  role="button"
                  >
                  <div class="service-item-info">
                    <h5 class="service-item-name">{{ service.name }}</h5>
                    <p class="service-item-description">{{ service.description }}</p>
                  </div>
                  <div class="service-item-arrow">
                    <span class="material-symbols-outlined">arrow_forward_ios</span>
                  </div>
                </div>
              }
            </div>
          }
        </div>
      }

      <!-- Empty State -->
      @if (filteredCategories.length === 0) {
        <div class="empty-state">
          <span class="material-symbols-outlined empty-icon">search_off</span>
          <p>No se encontraron servicios</p>
        </div>
      }
    </div>
  </main>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <button class="nav-item active">
      <span class="material-symbols-outlined filled">home</span>
      <span class="nav-text">Inicio</span>
    </button>
    <button class="nav-item">
      <span class="material-symbols-outlined">calendar_month</span>
      <span class="nav-text">Reservas</span>
    </button>
    <button class="nav-item">
      <span class="material-symbols-outlined">notifications</span>
      <span class="nav-text">Avisos</span>
    </button>
    <button class="nav-item">
      <div class="avatar-circle">
        <span class="material-symbols-outlined filled">person</span>
      </div>
      <span class="nav-text">Perfil</span>
    </button>
  </nav>
</div>
